# yaml-language-server: $schema=https://json.schemastore.org/github-workflow
name: Test report
on:
  workflow_call:
  push:
    paths:
      - 'others/test_report.html'
      - '.github/workflows/test_report.yaml'
  workflow_run:
    workflows:
      - Gesti√≥n Evaluaciones
      - Gesti√≥n Empresas
      - Gesti√≥n Usuarios
      - Gesti√≥n Evaluaciones
    types:
      - completed
    branches:
      - master
permissions:
  contents: write
  id-token: write

jobs:
  build:
    runs-on: ubuntu-latest
    concurrency: ci-${{ github.ref }}
    steps:
      - name: Checkout üõéÔ∏è
        uses: actions/checkout@v3

      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v4
        with:
          aws-region: us-east-1
          role-to-assume: arn:aws:iam::428011609647:role/github-actions-alpaca-role

      - name: Download reports from aws
        run: |
          aws s3 sync s3://abc-jobs-artifacts/test_reports _site

      - name: Copy index.html
        run: |
          cp others/test_report.html _site/index.html

      - name: Deploy üöÄ
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: _site
